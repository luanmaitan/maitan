---
import Layout from "../layouts/Layout.astro";
import { getCollection } from "astro:content";

// Fetch all content to count items (future use)
const allContent = await getCollection("escritorio");
const currentPath = Astro.url.pathname;
---

<Layout title="Maitan Hub | Escritório">
    <div
        slot="sidebar"
        class="w-full flex flex-col gap-8 md:flex-row md:items-center md:gap-6 lg:flex-col lg:items-start lg:gap-8"
    >
        <nav
            class="flex flex-col gap-2 md:flex-row md:gap-6 lg:flex-col lg:gap-2 w-full md:w-auto"
        >
            <a
                href="/"
                class="text-[15px] font-medium tracking-[-0.3px] text-neutral-500 hover:text-black dark:hover:text-white transition-colors lowercase mb-4 md:mb-0"
            >
                ← voltar
            </a>

            <div class="flex flex-col gap-1 mt-4">
                <p
                    class="text-xs font-bold text-neutral-400 uppercase tracking-widest mb-2"
                >
                    Categorias
                </p>
                <a href="/escritorio/ensaios" class="nav-item"
                    ><span class="nav-text">ensaios</span></a
                >
                <a href="/escritorio/dramaturgia" class="nav-item"
                    ><span class="nav-text">dramaturgia</span></a
                >
                <a href="/escritorio/poesia" class="nav-item"
                    ><span class="nav-text">poesia</span></a
                >
                <a href="/escritorio/autoficcoes" class="nav-item"
                    ><span class="nav-text">autoficções</span></a
                >
                <a href="/escritorio/impressoes" class="nav-item"
                    ><span class="nav-text">impressões</span></a
                >
                <a href="/escritorio/traducoes" class="nav-item"
                    ><span class="nav-text">traduções</span></a
                >
            </div>
        </nav>
    </div>

    <section class="space-y-12">
        <header>
            <h1
                class="text-[60px] leading-[0.95] tracking-tighter font-black text-black dark:text-white mb-4 lowercase"
            >
                escritório
            </h1>
            <p
                class="text-neutral-600 dark:text-neutral-400 leading-relaxed max-w-2xl"
            >
                Um jardim digital. Notas, ideias em estágio inicial e conexões
                mentais.
            </p>
        </header>

        <div class="space-y-12">
            {
                allContent.length > 0 ? (
                    allContent
                        .sort(
                            (a, b) =>
                                b.data.pubDate.valueOf() -
                                a.data.pubDate.valueOf(),
                        )
                        .map((note, index) => (
                            <div class="grid grid-cols-1 md:grid-cols-[40px_120px_1fr] gap-4 md:gap-8 group relative">
                                <div class="hidden md:block text-xs font-mono text-neutral-300 dark:text-neutral-600 pt-1.5 text-right">
                                    {String(index + 1).padStart(2, "0")}
                                </div>

                                <div class="text-xs font-mono text-neutral-400 dark:text-neutral-500 pt-1.5 uppercase tracking-wider">
                                    {note.data.pubDate
                                        .toLocaleDateString("pt-BR", {
                                            day: "2-digit",
                                            month: "short",
                                            year: "numeric",
                                        })
                                        .replace(".", "")
                                        .toUpperCase()}
                                </div>

                                <div class="space-y-2">
                                    <h3 class="text-lg font-medium text-neutral-900 dark:text-neutral-200 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
                                        <a
                                            href={`/escritorio/${note.slug}`}
                                            class="block lowercase"
                                        >
                                            {note.data.title}
                                        </a>
                                    </h3>
                                    <div class="flex items-center gap-2">
                                        <span class="text-[10px] uppercase tracking-wider text-neutral-500 border border-neutral-200 dark:border-neutral-700 px-1.5 py-0.5 rounded-sm">
                                            {note.data.category ||
                                                "sem categoria"}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        ))
                ) : (
                    <p class="text-neutral-500 dark:text-neutral-400 italic">
                        O jardim está sendo plantado.
                    </p>
                )
            }
        </div>
    </section>
</Layout>
