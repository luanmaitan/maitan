---
import Layout from "../layouts/Layout.astro";
import PageNav from "../components/PageNav.astro";
import { getCollection } from "astro:content";

// Fetch all content to count items (future use)
const allContent = await getCollection("escritorio");
const currentPath = Astro.url.pathname;
---

<Layout title="Maitan Hub | Escritório">
    <!-- Sidebar removed -->

    <section class="space-y-12">
        <header>
            <h1
                class="text-4xl md:text-5xl lg:text-[60px] leading-[0.95] tracking-tight font-bold text-black dark:text-white mb-4 lowercase"
            >
                escritório
            </h1>
            <PageNav
                items={[
                    { label: "ensaios", href: "/escritorio/ensaios" },
                    { label: "dramaturgia", href: "/escritorio/dramaturgia" },
                    { label: "poesia", href: "/escritorio/poesia" },
                    { label: "autoficções", href: "/escritorio/autoficcoes" },
                    { label: "impressões", href: "/escritorio/impressoes" },
                    { label: "traduções", href: "/escritorio/traducoes" },
                ]}
            />
        </header>

        <div class="space-y-12">
            {
                allContent.length > 0 ? (
                    allContent
                        .sort(
                            (a, b) =>
                                b.data.pubDate.valueOf() -
                                a.data.pubDate.valueOf(),
                        )
                        .map((note, index) => (
                            <div class="grid grid-cols-1 md:grid-cols-[40px_120px_1fr] gap-4 md:gap-8 group relative">
                                <div class="hidden md:block text-xs font-mono text-neutral-300 dark:text-neutral-600 pt-1.5 text-right">
                                    {String(index + 1).padStart(2, "0")}
                                </div>

                                <div class="text-xs font-mono text-neutral-400 dark:text-neutral-500 pt-1.5 uppercase tracking-wider">
                                    {note.data.pubDate
                                        .toLocaleDateString("pt-BR", {
                                            day: "2-digit",
                                            month: "short",
                                            year: "numeric",
                                        })
                                        .replace(".", "")
                                        .toUpperCase()}
                                </div>

                                <div class="space-y-2">
                                    <h3 class="text-lg font-medium text-neutral-900 dark:text-neutral-200 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors">
                                        <a
                                            href={`/escritorio/${note.slug}`}
                                            class="block lowercase"
                                        >
                                            {note.data.title}
                                        </a>
                                    </h3>
                                    <div class="flex items-center gap-2">
                                        <span class="text-[10px] uppercase tracking-wider text-neutral-500 border border-neutral-200 dark:border-neutral-700 px-1.5 py-0.5 rounded-sm">
                                            {note.data.category ||
                                                "sem categoria"}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        ))
                ) : (
                    <p class="text-neutral-500 dark:text-neutral-400 italic">
                        O jardim está sendo plantado.
                    </p>
                )
            }
        </div>
    </section>
</Layout>
