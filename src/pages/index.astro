---
// src/pages/index.astro
import Layout from '../layouts/Layout.astro';
import { getEvents, formatEventForCalendar } from '../lib/calendario';

// Carrega eventos para o calendário
const events = getEvents();
const formattedEvents = events.map(formatEventForCalendar);
---

<Layout title="Maitan Hub | Home">
	<section class="py-12 space-y-6">
		<span class="text-xs font-bold uppercase tracking-widest text-neutral-400">Now</span>
		
		<h1 class="text-4xl md:text-5xl font-serif font-medium leading-tight text-neutral-900 dark:text-neutral-100">
			Cultivando ideias, <br/>
			conectando narrativas e <br/>
			explorando interfaces.
		</h1>

		<p class="text-lg text-neutral-600 dark:text-neutral-400 font-serif max-w-xl leading-relaxed">
			Bem-vindo ao meu jardim digital. Este é um espaço de experimentação, 
			onde organizo meu <span class="text-neutral-900 dark:text-neutral-200 underline decoration-neutral-300 dark:decoration-neutral-700 decoration-1 underline-offset-4">knowledge management</span> 
			e compartilho projetos em andamento.
		</p>
	</section>

	<hr class="border-neutral-100 dark:border-neutral-800 my-12" />

	<section class="space-y-6">
		<div class="flex items-center justify-between">
			<h2 class="text-sm font-bold uppercase tracking-widest text-neutral-400 dark:text-neutral-500">Calendário</h2>
			<a href="/calendario" class="text-sm text-neutral-500 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-100 transition-colors">
				Ver completo →
			</a>
		</div>
		
		<!-- Calendário Compacto -->
		<div id="home-calendar" class="bg-white dark:bg-neutral-900 rounded-lg border border-neutral-200 dark:border-neutral-800 p-4"></div>
	</section>
</Layout>

<!-- FullCalendar CSS -->
<link href="https://cdn.jsdelivr.net/npm/@fullcalendar/core@6.1.10/main.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/@fullcalendar/daygrid@6.1.10/main.min.css" rel="stylesheet" />

<script define:vars={{ eventsData: formattedEvents }}>
    import { Calendar } from '@fullcalendar/core';
    import dayGridPlugin from '@fullcalendar/daygrid';
    import interactionPlugin from '@fullcalendar/interaction';

    // Inicializa o calendário compacto na home
    const calendarEl = document.getElementById('home-calendar');
    if (calendarEl) {
        const calendar = new Calendar(calendarEl, {
            plugins: [dayGridPlugin, interactionPlugin],
            initialView: 'dayGridMonth',
            initialDate: new Date(), // Ancora no dia atual
            headerToolbar: {
                left: 'prev,next',
                center: 'title',
                right: ''
            },
            locale: 'pt-br',
            firstDay: 1, // Segunda-feira
            events: eventsData,
            eventClick: function(info) {
                // Redireciona para a página completa do calendário
                window.location.href = '/calendario';
            },
            eventDisplay: 'block',
            height: 'auto',
            aspectRatio: 1.35,
            // Remove alguns elementos para versão compacta
            dayMaxEvents: 3,
            moreLinkClick: 'popover'
        });

        calendar.render();
    }
</script>

<style>
    /* Estilos customizados para FullCalendar na home */
    :global(#home-calendar .fc) {
        font-family: inherit;
    }

    :global(#home-calendar .fc-toolbar-title) {
        font-size: 1.25rem;
        font-weight: 500;
        color: rgb(23 23 23);
    }

    .dark :global(#home-calendar .fc-toolbar-title) {
        color: rgb(245 245 245);
    }

    :global(#home-calendar .fc-button) {
        background-color: rgb(23 23 23);
        border-color: rgb(23 23 23);
        color: white;
        padding: 0.375rem 0.75rem;
        border-radius: 0.5rem;
        font-size: 0.875rem;
        font-weight: 500;
        transition: all 0.2s;
    }

    .dark :global(#home-calendar .fc-button) {
        background-color: rgb(245 245 245);
        border-color: rgb(245 245 245);
        color: rgb(23 23 23);
    }

    :global(#home-calendar .fc-button:hover) {
        opacity: 0.9;
    }

    :global(#home-calendar .fc-daygrid-day) {
        background-color: transparent;
    }

    :global(#home-calendar .fc-daygrid-day-frame) {
        background-color: transparent;
    }

    :global(#home-calendar .fc-col-header-cell) {
        background-color: transparent;
        border-color: rgb(229 229 229);
        padding: 0.5rem;
    }

    .dark :global(#home-calendar .fc-col-header-cell) {
        border-color: rgb(38 38 38);
    }

    :global(#home-calendar .fc-col-header-cell-cushion) {
        color: rgb(115 115 115);
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.75rem;
        letter-spacing: 0.05em;
    }

    .dark :global(#home-calendar .fc-col-header-cell-cushion) {
        color: rgb(163 163 163);
    }

    :global(#home-calendar .fc-daygrid-day-number) {
        color: rgb(64 64 64);
        padding: 0.5rem;
        font-size: 0.875rem;
    }

    .dark :global(#home-calendar .fc-daygrid-day-number) {
        color: rgb(163 163 163);
    }

    :global(#home-calendar .fc-day-today) {
        background-color: rgb(250 250 250);
    }

    .dark :global(#home-calendar .fc-day-today) {
        background-color: rgb(23 23 23);
    }

    :global(#home-calendar .fc-event) {
        border-radius: 0.25rem;
        padding: 0.125rem 0.25rem;
        cursor: pointer;
        border: none;
        font-size: 0.75rem;
    }

    :global(#home-calendar .fc-event-title) {
        font-weight: 500;
        padding: 0.125rem 0.25rem;
    }

    :global(#home-calendar .fc-daygrid-event-dot) {
        display: none;
    }

    :global(#home-calendar .fc-more-link) {
        font-size: 0.75rem;
        color: rgb(115 115 115);
    }

    .dark :global(#home-calendar .fc-more-link) {
        color: rgb(163 163 163);
    }
</style>